# –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫—É–ø–æ–∫ —Å Telegram –±–æ—Ç–æ–º

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫—É–ø–æ–∫ –º–µ–∂–¥—É –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ Telegram –±–æ—Ç–æ–º. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫—É–ø–æ–∫ –∫–∞–∫ –Ω–∞ —Å–∞–π—Ç–µ, —Ç–∞–∫ –∏ –≤ Telegram, –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫—É–ø–æ–∫
- **‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã** (`pending`) - –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
- **üí∞ –û–ø–ª–∞—á–µ–Ω–æ** (`paid`) - –∑–∞–∫—É–ø–∫–∞ –æ–ø–ª–∞—á–µ–Ω–∞
- **üöö –í –ø—É—Ç–∏** (`in_transit`) - —Ç–æ–≤–∞—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
- **‚úÖ –ü–æ–ª—É—á–µ–Ω–æ** (`received`) - —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—É—á–µ–Ω—ã

### 2. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (/procurement)

#### –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫—É–ø–æ–∫
- –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–∫—É–ø–∫–∏
- –ê–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∞ —Ü–≤–µ—Ç–æ–º
- –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

#### –§—É–Ω–∫—Ü–∏–∏
```typescript
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫—É–ø–∫–∏
const handleStatusChange = async (purchaseId: string, newStatus: string) => {
  // 1. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
  // 2. –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  // 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
}
```

### 3. Telegram –±–æ—Ç

#### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–∫—É–ø–∫–∏
- –î–æ–±–∞–≤–ª—è—é—Ç—Å—è inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–∞
- –ö–Ω–æ–ø–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞

#### –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –≤ Telegram
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º —Å—Ç–∞—Ç—É—Å–æ–º
- –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### API Endpoints

#### Frontend API (Next.js)
```
PATCH /api/purchases/[id]/status
POST /api/telegram
POST /api/telegram/webhook
```

#### Backend API (Express + Prisma)
```
PATCH /api/purchases/:id/status - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
GET /api/purchases - —Å–ø–∏—Å–æ–∫ –∑–∞–∫—É–ø–æ–∫
POST /api/purchases - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫—É–ø–∫–∏
```

### Telegram API Integration

#### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–Ω–æ–ø–∫–∞–º–∏
```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏
await fetch('/api/telegram', {
  method: 'POST',
  body: JSON.stringify({
    message: telegramMessage,
    type: 'purchase',
    purchaseId: data.data.id,
    currentStatus: 'pending'
  })
})
```

#### Webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π
```typescript
// POST /api/telegram/webhook
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç callback_query –æ—Ç Telegram
// –§–æ—Ä–º–∞—Ç: status_purchaseId_newStatus
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

#### –ò–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ Telegram
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —Å–∞–π—Ç–µ
2. `handleStatusChange()` –æ–±–Ω–æ–≤–ª—è–µ—Ç –ë–î
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram —Å –Ω–æ–≤—ã–º —Å—Ç–∞—Ç—É—Å–æ–º

#### –ò–∑ Telegram –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤ Telegram
2. Webhook –ø–æ–ª—É—á–∞–µ—Ç callback_query
3. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –≤ –ë–î —á–µ—Ä–µ–∑ API
4. –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
5. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Telegram Bot
```env
TELEGRAM_BOT_TOKEN=8159006212:AAEjYn-bU-Nh89crlue9GUJKuv6pV4Z986M
TELEGRAM_CHAT_ID=-4729817036
```

### Webhook URL
–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤ Telegram:
```bash
curl -X POST "https://api.telegram.org/bot{TOKEN}/setWebhook" \
  -d "url=https://yourdomain.com/api/telegram/webhook"
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫—É–ø–∫–∏
1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/procurement`
2. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–∫—É–ø–∫—É"
3. –í Telegram –ø—Ä–∏–¥–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —Å–∞–π—Ç–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/procurement`
2. –í —Ç–∞–±–ª–∏—Ü–µ "–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫—É–ø–æ–∫" –Ω–∞–∂–º–∏—Ç–µ –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ç—É—Å–∞
3. –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è, –≤ Telegram –ø—Ä–∏–¥–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ Telegram
1. –ù–∞–π–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–∫—É–ø–∫–µ –≤ —á–∞—Ç–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ç—É—Å–∞
3. –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º —Å—Ç–∞—Ç—É—Å–æ–º

## –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–æ–∫

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- `pending` ‚Üí `paid` (–û–ø–ª–∞—á–µ–Ω–æ)
- `paid` ‚Üí `in_transit` (–í –ø—É—Ç–∏)  
- `in_transit` ‚Üí `received` (–ü–æ–ª—É—á–µ–Ω–æ)

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å—Ç–∞—Ç—É—Å—ã
- –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –≤—ã–¥–µ–ª–µ–Ω —Ü–≤–µ—Ç–æ–º
- –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ "–ü–æ–ª—É—á–µ–Ω–æ" –∫–Ω–æ–ø–∫–∏ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Webhook –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∞ backend
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å fallback
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ backend —Å–µ—Ä–≤–µ—Ä–∞
- Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 
